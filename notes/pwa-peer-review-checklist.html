<!DOCTYPE html>
<html>

<head>
  <title>Assignment Checklist</title>
  <meta charset="utf-8" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

  <style>
    body {
      padding: 1.0em;
      margin: 0;
      font-size: 1.2em;
    }

    .checklist {
      width: 100%;
    }

    tr td,
    tr th {
      padding: 0.5em;
      overflow: auto;
    }

    th {
      font-size: 1.0em;
      background-color: whitesmoke;
    }

    th,
    td {
      border: 1px solid grey;
    }

    .col1,
    .col5 {
      width: 35%;
    }

    .col2,
    .col3,
    .col4 {
      width: 8%;
    }

    .no-storage {
      display: none;
    }

    @media print {

      .no-print,
      .no-print * {
        display: none !important;
      }
    }
  </style>
</head>

<body>
  <div class="alert alert-danger no-print no-storage" role="alert">
    <p>This browser doesn't support localStorage. Your progress will not be saved automatically.</p>
  </div>
  <h4>Summer School 2019 - Peer Review - <span id="studentName" contenteditable="true">(Team X review of Team Y
      progress)</span></h4>
  <p>Peer review feedback on Tuesday 13 August</p>
  <table class="checklist">
    <tr>
      <th class="col1">Navigation and routing</th>
      <th class="col2">Complete</th>
      <th class="col3">Partial</th>
      <th class="col4">Missing</th>
      <th class="col5">Comments</th>
    </tr>
    <tr>
      <td>App layout is mostly complete, and has a responsive design</td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
    </tr>
    <tr>
      <td>Includes most of the Sofie-supplied items, plus our own</td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
    </tr>
    <tr>
      <td>Has easy (one tap) access to change the language</td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
    </tr>
    <tr>
        <td>User interface is localized</td>
        <td>
          <div contenteditable="true"></div>
        </td>
        <td>
          <div contenteditable="true"></div>
        </td>
        <td>
          <div contenteditable="true"></div>
        </td>
        <td>
          <div contenteditable="true"></div>
        </td>
      </tr>
    </table>
  <p>&nbsp;</p>
  <table class="checklist">
    <tr>
      <th class="col1">Login and settings</th>
      <th class="col2">Complete</th>
      <th class="col3">Partial</th>
      <th class="col4">Missing</th>
      <th class="col5">Comments</th>
    </tr>
    <tr>
      <td>Login button is on the home screen (at the bottom?)</td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
    </tr>
    <tr>
      <td>Login feature is implemented, and there is a plan to protect some content/features</td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
    </tr>
  </table>
  <p>&nbsp;</p>
  <table class="checklist">
    <tr>
      <th class="col1">Content delivery</th>
      <th class="col2">Complete</th>
      <th class="col3">Partial</th>
      <th class="col4">Missing</th>
      <th class="col5">Comments</th>
    </tr>
    <tr>
      <td>Sample content (lorem ipsum or Wikipedia articles) for all content items</td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
    </tr>
    <tr>
      <td>Content is in more than one language<br>Arabic content is displayed right-to-left</td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
    </tr>
    <tr>
      <td>The team has a strategy for caching the content</td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
    </tr>
  </table>
  <p>&nbsp;</p>
  <table class="checklist">
    <tr>
      <th class="col1">Custom feature - <span contenteditable="true">name</span></th>
      <th class="col2">Complete</th>
      <th class="col3">Partial</th>
      <th class="col4">Missing</th>
      <th class="col5">Comments</th>
    </tr>
    <tr>
      <td>An interim version of the component (and how-to-use info) is available<br>It uses the web API for data delivery and/or update</td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
    </tr>
    <tr>
      <td>The feature's design has been explained</td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
    </tr>
  </table>
  <p>&nbsp;</p>
  <table class="checklist">
    <tr>
      <th class="col1">Code quality<br>Show an example of the code that is or will be in the app</th>
      <th class="col2">Complete</th>
      <th class="col3">Partial</th>
      <th class="col4">Missing</th>
      <th class="col5">Comments</th>
    </tr>
    <tr>
      <td>Overall, usage and code quality is good, follows
        best practices, and implements prior learning</td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
      <td>
        <div contenteditable="true"></div>
      </td>
    </tr>
    <tr>
        <td>Team has been able to build a shared code base after working on different parts individually</td>
        <td>
          <div contenteditable="true"></div>
        </td>
        <td>
          <div contenteditable="true"></div>
        </td>
        <td>
          <div contenteditable="true"></div>
        </td>
        <td>
          <div contenteditable="true"></div>
        </td>
      </tr>
    </table>
  <p>&nbsp;</p>
  <p>Other comments:</p>
  <p id="comments" contenteditable="true"></p>
  <p><button id="reset" class="btn btn-default no-print" type="reset" onclick="resetForm()">Clear the content</button>
  </p>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-beta1/jquery.min.js"></script>
  <script>
    var delay = (function () {
      var timer = 0;
      return function (callback, ms) {
        clearTimeout(timer);
        timer = setTimeout(callback, ms);
      };
    })();

    $('body').keyup(function () {
      delay(function () {
        saveOrRepopulate(true);
      }, 3000);
    });

    $(document).ready(
      function () {
        if (typeof (Storage) !== "undefined") {
          // Code for localStorage/sessionStorage.
          $(".no-storage").hide();
          saveOrRepopulate();
        } else {
          // Sorry! No Web Storage support..
          $(".no-storage").show();
          $("#reset").hide();
        }
      }
    )

    if (typeof (Storage) !== "undefined") {
      function saveOrRepopulate(save) {
        var form = [], firstLoad = false, oldForm, btiFormEmpty = false, originalEmpty = false;

        console.log("local:");
        console.log(localStorage);
        //localStorage.originalValues = JSON.stringify(form);

        if (!localStorage.btiForm || localStorage.btiForm === "[]") {
          btiFormEmpty = true;
        }

        if (!localStorage.originalValues || localStorage.originalValues === "[]") {
          originalEmpty = true;
        }

        if (!btiFormEmpty && !save) {
          oldForm = JSON.parse(localStorage.btiForm);
          $("#studentName").html(localStorage.studentName);
          $("#comments").html(localStorage.comments);
        }

        if (btiFormEmpty && originalEmpty) {
          firstLoad = true;
        }

        $(".checklist").each(function (tableI, table) {
          var rows = $(table).find("tr"), rowData = [];

          rows.each(function (rowI, row) {
            var cells = $(row).find("td"), cellData = [];

            cells.each(function (cellI, cell) {
              var divs = $(cell).find("div"), i, divData = [];

              for (i = 0; i < divs.length; i++) {
                if (save || firstLoad) {
                  divData.push($(divs[i]).html());
                  console.log("first/save");
                } else {
                  console.log("repopulating");
                  if (oldForm && oldForm[tableI] && oldForm[tableI][rowI] &&
                    oldForm[tableI][rowI][cellI] && oldForm[tableI][rowI][cellI][i]) {
                    $(divs[i]).html(oldForm[tableI][rowI][cellI][i]);
                  } else {
                    $(divs[i]).html("");
                  }
                }
              }

              cellData.push(divData)
            })

            rowData.push(cellData);

          });

          if (rowData) {
            form.push(rowData);
          }

        });

        if (firstLoad) {
          console.log("first load...");
          console.log(form);
          console.log("local original");
          console.log(localStorage.originalValues);
          localStorage.originalValues = JSON.stringify(form);
        }

        if (save) {
          localStorage.btiForm = JSON.stringify(form);
        }

        localStorage.studentName = $("#studentName").html();
        localStorage.comments = $("#comments").html();
      }

      function resetForm() {
        localStorage.btiForm = [];//localStorage.originalValues;

        localStorage.studentName = "";
        $("#studentName").html("name");

        localStorage.comments = "";
        $("#comments").html("");

        saveOrRepopulate();
      }
    }
  </script>
</body>

</html>